!function(){var e,t,i,n={};function o(e){Office.context.mailbox.item.notificationMessages.replaceAsync("github-error",{type:"errorMessage",message:e},(function(e){}))}function c(n){e=JSON.parse(n.message),setConfig(e,(function(e){i.close(),i=null,t.completed(),t=null}))}function a(e){i=null,t.completed(),t=null}n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),Office.onReady((function(){})),("undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==n.g?n.g:void 0).action=function(e){var t={type:Office.MailboxEnums.ItemNotificationMessageType.InformationalMessage,message:"Performed action.",icon:"Icon.80x80",persistent:!0};Office.context.mailbox.item.notificationMessages.replaceAsync("action",t),e.completed()},Office.initialize=function(){},Office.actions.associate("insertDefaultGist",(function(n){if((e=getConfig())&&e.defaultGistId)try{getGist(e.defaultGistId,(function(e,t){e?buildBodyContent(e,(function(e,t){e?Office.context.mailbox.item.body.setSelectedDataAsync(e,{coercionType:Office.CoercionType.Html},(function(e){n.completed()})):(o(t),n.completed())})):(o(t),n.completed())}))}catch(e){o(e),n.completed()}else{t=n;var l=new URI("dialog.html?warn=1").absoluteTo(window.location).toString();Office.context.ui.displayDialogAsync(l,{width:20,height:40,displayInIframe:!0},(function(e){(i=e.value).addEventHandler(Office.EventType.DialogMessageReceived,c),i.addEventHandler(Office.EventType.DialogEventReceived,a)}))}})),Office.actions.associate("insertCredentials",(function(n){if(console.log("inside insert credentials"),(e=getConfig())&&e.applicationUserName&&e.applicationPassName)try{getToken(e.applicationUserName,e.applicationPassName,(function(e,t){e?(console.log("-- gist"),console.log(e),console.log("--gist 2"),console.log(e.data.user),buildBodyContent(e,(function(e,t){e?(console.log("--data"),console.log(e)):(o(t),n.completed())}))):(o(t),n.completed())}))}catch(e){o(e),n.completed()}else{t=n;var l=new URI("dialog.html?warn=1").absoluteTo(window.location).toString();Office.context.ui.displayDialogAsync(l,{width:20,height:40,displayInIframe:!0},(function(e){(i=e.value).addEventHandler(Office.EventType.DialogMessageReceived,c),i.addEventHandler(Office.EventType.DialogEventReceived,a)}))}}))}();
//# sourceMappingURL=commands.js.map